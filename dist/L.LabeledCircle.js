(function(t){if(typeof exports==="object"&&typeof module!=="undefined"){module.exports=t()}else if(typeof define==="function"&&define.amd){define([],t)}else{var i;if(typeof window!=="undefined"){i=window}else if(typeof global!=="undefined"){i=global}else if(typeof self!=="undefined"){i=self}else{i=this}(i.L||(i.L={})).LabeledCircleMarker=t()}})(function(){var t,i,e;return function r(t,i,e){function n(a,s){if(!i[a]){if(!t[a]){var l=typeof require=="function"&&require;if(!s&&l)return l(a,!0);if(o)return o(a,!0);var h=new Error("Cannot find module '"+a+"'");throw h.code="MODULE_NOT_FOUND",h}var p=i[a]={exports:{}};t[a][0].call(p.exports,function(i){var e=t[a][1][i];return n(e?e:i)},p,p.exports,r,t,i,e)}return i[a].exports}var o=typeof require=="function"&&require;for(var a=0;a<e.length;a++)n(e[a]);return n}({1:[function(t,i,e){"use strict";i.exports=t("./src/marker")},{"./src/marker":7}],2:[function(t,i,e){t("./src/Path.Transform");t("./src/Path.Drag");t("./src/MultiPoly.Drag");i.exports=L.Path.Drag},{"./src/MultiPoly.Drag":3,"./src/Path.Drag":4,"./src/Path.Transform":5}],3:[function(t,i,e){(function(){L.FeatureGroup.EVENTS+=" dragstart";function t(t,i,e){for(var r=0,n=t.length;r<n;r++){var o=t[r];o.prototype["_"+i]=o.prototype[i];o.prototype[i]=e}}function i(t){if(this.hasLayer(t)){return this}t.on("drag",this._onDrag,this).on("dragend",this._onDragEnd,this);return this._addLayer.call(this,t)}function e(t){if(!this.hasLayer(t)){return this}t.off("drag",this._onDrag,this).off("dragend",this._onDragEnd,this);return this._removeLayer.call(this,t)}t([L.MultiPolygon,L.MultiPolyline],"addLayer",i);t([L.MultiPolygon,L.MultiPolyline],"removeLayer",e);var r={_onDrag:function(t){var i=t.target;this.eachLayer(function(t){if(t!==i){t._applyTransform(i.dragging._matrix)}});this._propagateEvent(t)},_onDragEnd:function(t){var i=t.target;this.eachLayer(function(t){if(t!==i){t._resetTransform();t.dragging._transformPoints(i.dragging._matrix)}});this._propagateEvent(t)}};L.MultiPolygon.include(r);L.MultiPolyline.include(r)})()},{}],4:[function(t,i,e){/**
 * Leaflet vector features drag functionality
 * @preserve
 */
"use strict";L.Handler.PathDrag=L.Handler.extend({statics:{DRAGGABLE_CLS:"leaflet-path-draggable"},initialize:function(t){this._path=t;this._matrix=null;this._startPoint=null;this._dragStartPoint=null;this._dragInProgress=false;this._dragMoved=false},addHooks:function(){var t=L.Handler.PathDrag.DRAGGABLE_CLS;var i=this._path._path;this._path.on("mousedown",this._onDragStart,this);this._path.options.className=(this._path.options.className||"")+" "+t;if(!L.Path.CANVAS&&i){L.DomUtil.addClass(i,t)}},removeHooks:function(){var t=L.Handler.PathDrag.DRAGGABLE_CLS;var i=this._path._path;this._path.off("mousedown",this._onDragStart,this);this._path.options.className=(this._path.options.className||"").replace(t,"");if(!L.Path.CANVAS&&i){L.DomUtil.removeClass(i,t)}this._dragMoved=false},moved:function(){return this._dragMoved},inProgress:function(){return this._dragInProgress},_onDragStart:function(t){this._dragInProgress=true;this._startPoint=t.containerPoint.clone();this._dragStartPoint=t.containerPoint.clone();this._matrix=[1,0,0,1,0,0];if(this._path._point){this._point=this._path._point.clone()}this._path._map.on("mousemove",this._onDrag,this).on("mouseup",this._onDragEnd,this);this._dragMoved=false},_onDrag:function(t){var i=t.containerPoint.x;var e=t.containerPoint.y;var r=this._matrix;var n=this._path;var o=this._startPoint;var a=i-o.x;var s=e-o.y;if(!this._dragMoved&&(a||s)){this._dragMoved=true;n.fire("dragstart");if(n._popup){n._popup._close();n.off("click",n._openPopup,n)}}r[4]+=a;r[5]+=s;o.x=i;o.y=e;n._applyTransform(r);if(n._point){n._point.x=this._point.x+r[4];n._point.y=this._point.y+r[5]}n.fire("drag");L.DomEvent.stop(t.originalEvent)},_onDragEnd:function(t){L.DomEvent.stop(t);L.DomEvent._fakeStop({type:"click"});this._dragInProgress=false;this._path._resetTransform();this._transformPoints(this._matrix);this._path._map.off("mousemove",this._onDrag,this).off("mouseup",this._onDragEnd,this);this._path.fire("dragend",{distance:Math.sqrt(L.LineUtil._sqDist(this._dragStartPoint,t.containerPoint))});if(this._path._popup){L.Util.requestAnimFrame(function(){this._path.on("click",this._path._openPopup,this._path)},this)}this._matrix=null;this._startPoint=null;this._point=null;this._dragStartPoint=null},_transformPoint:function(t,i){var e=this._path;var r=L.point(i[4],i[5]);var n=e._map.options.crs;var o=n.transformation;var a=n.scale(e._map.getZoom());var s=n.projection;var l=o.untransform(r,a).subtract(o.untransform(L.point(0,0),a));return s.unproject(s.project(t)._add(l))},_transformPoints:function(t){var i=this._path;var e,r,n;var o=L.point(t[4],t[5]);var a=i._map.options.crs;var s=a.transformation;var l=a.scale(i._map.getZoom());var h=a.projection;var p=s.untransform(o,l).subtract(s.untransform(L.point(0,0),l));if(i._point){i._latlng=h.unproject(h.project(i._latlng)._add(p));i._point=this._point._add(o)}else if(i._originalPoints){for(e=0,r=i._originalPoints.length;e<r;e++){n=i._latlngs[e];i._latlngs[e]=h.unproject(h.project(n)._add(p));i._originalPoints[e]._add(o)}}if(i._holes){for(e=0,r=i._holes.length;e<r;e++){for(var _=0,g=i._holes[e].length;_<g;_++){n=i._holes[e][_];i._holes[e][_]=h.unproject(h.project(n)._add(p));i._holePoints[e][_]._add(o)}}}i._updatePath()}});L.Path.addInitHook(function(){if(this.options.draggable){if(this.dragging){this.dragging.enable()}else{this.dragging=new L.Handler.PathDrag(this);this.dragging.enable()}}else if(this.dragging){this.dragging.disable()}});L.Circle.prototype._getLatLng=L.Circle.prototype.getLatLng;L.Circle.prototype.getLatLng=function(){if(this.dragging&&this.dragging.inProgress()){return this.dragging._transformPoint(this._latlng,this.dragging._matrix)}else{return this._getLatLng()}};L.Polyline.prototype._getLatLngs=L.Polyline.prototype.getLatLngs;L.Polyline.prototype.getLatLngs=function(){if(this.dragging&&this.dragging.inProgress()){var t=this.dragging._matrix;var i=this._getLatLngs();for(var e=0,r=i.length;e<r;e++){i[e]=this.dragging._transformPoint(i[e],t)}return i}else{return this._getLatLngs()}}},{}],5:[function(t,i,e){"use strict";if(L.Browser.svg){L.Path.include({_resetTransform:function(){this._container.setAttributeNS(null,"transform","")},_applyTransform:function(t){this._container.setAttributeNS(null,"transform","matrix("+t.join(" ")+")")}})}else{L.Path.include({_resetTransform:function(){if(this._skew){this._skew.on=false;this._container.removeChild(this._skew);this._skew=null}},_applyTransform:function(t){var i=this._skew;if(!i){i=this._createElement("skew");this._container.appendChild(i);i.style.behavior="url(#default#VML)";this._skew=i}var e=t[0].toFixed(8)+" "+t[1].toFixed(8)+" "+t[2].toFixed(8)+" "+t[3].toFixed(8)+" 0 0";var r=Math.floor(t[4]).toFixed()+", "+Math.floor(t[5]).toFixed()+"";var n=this._container.style;var o=parseFloat(n.left);var a=parseFloat(n.top);var s=parseFloat(n.width);var l=parseFloat(n.height);if(isNaN(o))o=0;if(isNaN(a))a=0;if(isNaN(s)||!s)s=1;if(isNaN(l)||!l)l=1;var h=(-o/s-.5).toFixed(8)+" "+(-a/l-.5).toFixed(8);i.on="f";i.matrix=e;i.origin=h;i.offset=r;i.on=true}})}L.Path.include({_onMouseClick:function(t){if(this.dragging&&this.dragging.moved()||this._map.dragging&&this._map.dragging.moved()){return}this._fireMouseEvent(t)}})},{}],6:[function(t,i,e){"use strict";i.exports=L.CircleMarker.extend({options:{textStyle:{color:"#fff",fontSize:12},shiftY:6},initialize:function r(t,i,e){this._text=t;L.CircleMarker.prototype.initialize.call(this,i,e)},setText:function n(t){this._text=t;if(this._textNode){this._textElement.removeChild(this._textNode)}this._textNode=document.createTextNode(this._text);this._textElement.appendChild(this._textNode);return this},_initPath:function o(){L.CircleMarker.prototype._initPath.call(this);this._textElement=this._createElement("text");this.setText(this._text);this._container.appendChild(this._textElement)},_updatePath:function a(){L.CircleMarker.prototype._updatePath.call(this);this._updateTextPosition()},onAdd:function s(t){L.CircleMarker.prototype.onAdd.call(this,t);this._updateTextPosition();return this},_updateTextPosition:function l(){var t=this._textElement;var i=t.getBBox();var e=this._point.subtract(L.point(i.width,-i.height+this.options.shiftY).divideBy(2));t.setAttribute("x",e.x);t.setAttribute("y",e.y)},_updateStyle:function h(){L.CircleMarker.prototype._updateStyle.call(this);var t=this.options.textStyle;for(var i in t){if(t.hasOwnProperty(i)){var e=i;if(i==="color"){e="stroke"}this._textElement.style[e]=t[i]}}}})},{}],7:[function(t,i,e){(function(e){"use strict";var r=typeof window!=="undefined"?window["L"]:typeof e!=="undefined"?e["L"]:null;var n=t("./circle");t("leaflet-path-drag");var o=r.FeatureGroup.extend({options:{getLabelText:function a(t,i){return i.properties.text},getLabelPosition:function s(t,i,e){return i.properties.labelPosition?r.latLng(i.properties.labelPosition.slice().reverse()):e},labelPositionKey:"labelPosition",markerOptions:{color:"#f00",fillOpacity:.8,draggable:true,radius:15},anchorOptions:{color:"#00f",radius:3},lineOptions:{color:"#f00",dashArray:[5,15],lineCap:"square"}},initialize:function l(t,i,e){r.Util.setOptions(this,e);this.feature=i||{type:"Feature",properties:{},geometry:{type:"Point"}};this._latlng=t;this._marker=null;this._anchor=null;this._line=null;this._createLayers();r.LayerGroup.prototype.initialize.call(this,[this._anchor,this._line,this._marker])},getLabelPosition:function h(){return this._marker.getLatLng()},getLatLng:function p(){return this._latlng},toGeoJSON:function _(){var t=r.GeoJSON.getFeature(this,{type:"Point",coordinates:r.GeoJSON.latLngToCoords(this._anchor.getLatLng())});t.properties[this.options.labelPositionKey]=r.GeoJSON.latLngToCoords(this._marker.getLatLng());return t},setText:function g(t){this._marker.setText(t);return this},_createLayers:function f(){var t=this.options;var i=t.getLabelPosition(this,this.feature,this._latlng);var e=t.getLabelText(this,this.feature);this._marker=new n(e,i,r.Util.extend({},o.prototype.options.markerOptions,t.markerOptions)).on("drag",this._onMarkerDrag,this);this._anchor=new r.CircleMarker(this._latlng,r.Util.extend({},o.prototype.options.anchorOptions,t.anchorOptions));this._line=new r.Polyline([this._latlng,this._marker.getLatLng()],r.Util.extend({},o.prototype.options.lineOptions,t.lineOptions))},_onMarkerDrag:function u(t){this._line.setLatLngs([t.target.getLatLng(),this._latlng])}});i.exports=r.LabeledCircleMarker=o;r.labeledCircleMarker=function(t,i,e){return new o(t,i,e)}}).call(this,typeof global!=="undefined"?global:typeof self!=="undefined"?self:typeof window!=="undefined"?window:{})},{"./circle":6,"leaflet-path-drag":2}]},{},[1])(1)});